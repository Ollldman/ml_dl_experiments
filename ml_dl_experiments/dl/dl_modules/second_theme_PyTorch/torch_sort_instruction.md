## PyTorch Sorting Cheatsheet

### üîç **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

```python
torch.sort(input, dim=-1, descending=False, stable=False)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (values, indices)

torch.argsort(input, dim=-1, descending=False, stable=False)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ indices

torch.topk(input, k, dim=-1, largest=True, sorted=True)
# k –Ω–∞–∏–±–æ–ª—å—à–∏—Ö/–Ω–∞–∏–º–µ–Ω—å—à–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```

### üìä **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∏–∑–º–µ—Ä–µ–Ω–∏—é**

```python
# 1D —Ç–µ–Ω–∑–æ—Ä
x = torch.tensor([3, 1, 4, 1, 5])
values, indices = torch.sort(x)  # dim –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -1

# 2D —Ç–µ–Ω–∑–æ—Ä - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫
x = torch.tensor([[3, 1, 4], [1, 5, 9]])
values, indices = torch.sort(x, dim=1)  # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏

# 2D —Ç–µ–Ω–∑–æ—Ä - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
values, indices = torch.sort(x, dim=0)  # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
```

### üéØ **–ß–∞—Å—Ç–∏—á–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (top-k)**

```python
x = torch.tensor([3, 1, 4, 1, 5])
values, indices = torch.topk(x, k=3)  # 3 –Ω–∞–∏–±–æ–ª—å—à–∏—Ö
values, indices = torch.topk(x, k=3, largest=False)  # 3 –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö
```

### üîÑ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**

```python
# –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (PyTorch 1.9+)
values, indices = torch.sort(x, stable=True)
```

### üìê **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤**

```python
# 3D —Ç–µ–Ω–∑–æ—Ä: [batch, seq_len, features]
x = torch.randn(2, 3, 4)

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –∏–∑–º–µ—Ä–µ–Ω–∏—é
values, indices = torch.sort(x, dim=-1)

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ç–æ—Ä–æ–º—É –∏–∑–º–µ—Ä–µ–Ω–∏—é
values, indices = torch.sort(x, dim=1)

# –ü–æ–ª–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å flatten
flattened, indices = torch.sort(x.flatten())
```

### üõ† **–ü–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**

```python
# 1. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞
x = torch.tensor([3, 1, 4, 1, 5])
values, indices = torch.sort(x)
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏–∑ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ
original_order = torch.zeros_like(values)
original_order[indices] = values

# 2. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –¥—Ä—É–≥–æ–≥–æ —Ç–µ–Ω–∑–æ—Ä–∞
data = torch.tensor([5, 3, 7, 1])
keys = torch.tensor([20, 10, 40, 30])
sorted_keys, indices = torch.sort(keys)
sorted_data = data[indices]  # [3, 5, 1, 7]

# 3. k –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
k = 2
smallest_values, indices = torch.topk(x, k=k, largest=False)

# 4. –ü–æ–ª—É—á–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏–π
indices = torch.argsort(x)

# 5. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
values, indices = torch.sort(x, descending=True)
```

### ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ stable=True –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–Ω–∞—á–µ–Ω–∏–π
# GPU —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
# –î–ª—è –±–æ–ª—å—à–∏—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤ consider topk –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
```

### üìù **–¢–∏–ø–∏—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏**

- `dim=-1`: –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `dim=0`: –ø–µ—Ä–≤–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ (batch –¥–ª—è 2D+)
- `dim=1`: –≤—Ç–æ—Ä–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ (–æ–±—ã—á–Ω–æ sequence)
- `dim=2`: —Ç—Ä–µ—Ç—å–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ (–æ–±—ã—á–Ω–æ features)

### ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**

1. `torch.sort` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ `(values, indices)`
2. `indices` –∏–º–µ—é—Ç —Ç–æ—Ç –∂–µ shape, —á—Ç–æ –∏ input
3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ dtypes
4. –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å PyTorch 1.9+
5. –î–ª—è nan –∑–Ω–∞—á–µ–Ω–∏–π: nan –≤—Å–µ–≥–¥–∞ –∏–¥—É—Ç –≤ –∫–æ–Ω–µ—Ü